---
title: "Shiny PR2"
author: ""
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Shiny PR2}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  cache = FALSE,
  warning = FALSE,
  message = FALSE,
  prompt=FALSE,
  tidy=FALSE,
  comment = "#>" 
#  fig.path = "img/"   # Directories where image are saved
)

# Notes
# - cannot use rmarkdown::html_vignette for the moment (maybe with R version 4.0)
# - use devtools::build_vignettes() to build the vignettes
# - need to build source package to have the vignettes
```

### PR2 Shiny application

Here is a short description of the different panels

#### Taxonomy

Listing of taxonomy used for PR2 with number of sequences for each species

* First Select Taxa on the left Menu by navigating the menu
* Once you have selected the taxonomy press **VALIDATE TAXA** and you should see the table of taxons
* To reset the taxonomy press **RESET TAXA** followed by **VALIDATE TAXA**.
* You can save and reload your favorite taxa on the bottom left of the screen
```{r echo=FALSE, out.width="60%", fig.cap="Fig. 1: Selection menu."}

htmltools::img(src = "img/pr2-shiny-01.png", 
               style = 'position:relative; left:0px; top:0px; padding:10px;',
               width = "1100px")
htmltools::img(src = "img/pr2-shiny-02.png", 
               style = 'position:relative; left:0px; top:0px; padding:10px;',
               width = "1100px")
```
<br />
<br />

#### Sequences

Listing of PR2 sequences for the selected taxa with the following information provided.

You can filter on the left menu the sequences by:

* Length
* Type of samples: corresponds to sample origin as detailed in the GenBank record or the original paper
          
  
| Type  | Origin  | Sequence #  |
|---|---|---|
|culture   |  Well-defined culture |  38703 |
|environmental   | e.g. oceanic water or soil  | 81808  |
| isolate  |  Organism isolated for example by pipetting but not in culture | 26774  |
| specimen   | e.g. from a plant species  | 22218  |
|unknown   |  no information available  | 28098  |

The following information is provided:

* PR2 accession number
* PR2 species assignement
* Sequence length
* Sample type as annotated by PR2
* Definition and Taxonomy provided by GenBank

```{r echo=FALSE, out.width="60%", fig.cap="Fig. 1: Selection menu."}
# knitr::include_graphics("img/select_01.png")

htmltools::img(src = "img/pr2-shiny-03.png", 
               style = 'position:relative; left:0px; top:0px; padding:10px;',
               width = "1100px")
```
<br />
<br />

#### Download selected sequences

Download PR2 sequences and their metadata for the selected taxa

You can filter on the left menu the sequences by:
* Length
* Type of samples

The description of the files is provided on the page.

```{r echo=FALSE, out.width="60%", fig.cap="Fig. 1: Selection menu."}
# knitr::include_graphics("img/select_01.png")

htmltools::img(src = "img/pr2-shiny-04.png", 
               style = 'position:relative; left:0px; top:0px; padding:10px;',
               width = "1100px")
```
<br />
<br />

#### Download full database

Download full database if you use PR2 to annotate metabarcodes. 

Files are provided for:
* dada2
* mothur
* qiime
* DECIPHER
* vsearch
* usearch

```{r echo=FALSE, out.width="60%", fig.cap="Fig. 1: Selection menu."}
# knitr::include_graphics("img/select_01.png")

htmltools::img(src = "img/pr2-shiny-05.png", 
               style = 'position:relative; left:0px; top:0px; padding:10px;',
               width = "1100px")
```
<br />
<br />

#### Query

You can perform a BLAST like search on the whole PR2 database (not only on the selected taxa).

You can filter the sequences based on similarity level and download these sequences as well as their metadata.


```{r echo=FALSE, out.width="60%", fig.cap="Fig. 1: Selection menu."}
# knitr::include_graphics("img/select_01.png")

htmltools::img(src = "img/pr2-shiny-06.png", 
               style = 'position:relative; left:0px; top:0px; padding:10px;',
               width = "1100px")
```
<br />
<br />
